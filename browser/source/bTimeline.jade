extends layout



append head-title

    title Таймлайн...

append head-styles

    link(rel='stylesheet', href='styles/index.css')

append head-scripts

    script(src='scripts/bTimeline.js')
    script.

        /*
         * TimelineExample
         */
        angular.module('TimelineExample', ['bTimeline'])

            .controller('TimelineCtrl', function ($scope, $interval) {
                console.log('timeline ctrl.', $scope)

                this.splitIntervalToChunks= function (beginDate, endDate, numOfChunks) {
                    var chunkDuration= (endDate - beginDate) / numOfChunks
                    var chunks= []
                    for (var i= 0, date= new Date(beginDate); i < numOfChunks; i++, date.setTime(date.getTime() + chunkDuration)) {
                        var chunkBeginDate= new Date(date)
                        var chunkEndDate= new Date(chunkBeginDate)
                        chunkEndDate.setTime( chunkEndDate.getTime() + chunkDuration )
                        var chunk= {
                            beginDate: chunkBeginDate,
                            endDate: chunkEndDate,
                        }
                        chunks.push(chunk)
                    }
                    return chunks
                }

                this.findFirstDayOfWeek= function (date) {
                    var resultDate= new Date(date.getFullYear(), date.getMonth(), date.getDate())
                    resultDate.setHours( ((resultDate.getDay() || 7) - 1) * -24 )
                    return resultDate
                }

                this.beginDate= this.findFirstDayOfWeek(new Date)
                this.endDate= new Date(this.beginDate); this.endDate.setDate( this.endDate.getDate() + 7 )

                this.intervals= [
                    //{ beginDate:this.beginDate, endDate:this.endDate },
                ]

                var beginDate, endDate= this.beginDate

                beginDate= new Date(endDate); beginDate.setDate( beginDate.getDate() - 1)
                endDate= new Date(beginDate); endDate.setDate( endDate.getDate() + 1 ); endDate.setHours( endDate.getHours() + 7 )
                this.intervals.push({
                    beginDate: beginDate,
                    endDate: endDate,
                })

                beginDate= new Date(endDate); beginDate.setDate( beginDate.getDate() + 1)
                endDate= new Date(beginDate); endDate.setDate( endDate.getDate() + 2 )
                this.intervals.push({
                    beginDate: beginDate,
                    endDate: endDate,
                })

                beginDate= new Date(endDate); beginDate.setHours( beginDate.getHours() + 3)
                endDate= new Date(beginDate); endDate.setHours( endDate.getHours() + 7 )
                this.intervals.push({
                    beginDate: beginDate,
                    endDate: endDate,
                })

                beginDate= new Date(endDate); beginDate.setHours( beginDate.getHours() + 3)
                endDate= new Date(beginDate); endDate.setHours( endDate.getHours() + 7 )
                this.intervals.push({
                    beginDate: beginDate,
                    endDate: endDate,
                })

                beginDate= new Date(endDate); beginDate.setHours( beginDate.getHours() + 3)
                endDate= new Date(beginDate); endDate.setHours( endDate.getHours() + 7 )
                this.intervals.push({
                    beginDate: beginDate,
                    endDate: endDate,
                })

                beginDate= new Date(this.endDate); beginDate.setHours( beginDate.getHours() - 17)
                endDate= new Date(this.endDate); endDate.setHours( endDate.getHours() + 7 )
                this.intervals.push({
                    beginDate: beginDate,
                    endDate: endDate,
                })

                $interval(function () {
                    var endDate= this.intervals[3].endDate
                    endDate.setMinutes(
                        endDate.getMinutes() + 1
                    )
                }.bind(this), 1000)

            })

        ;



append body

    .b-app(app, ng-app="TimelineExample", ng-cloak)

        .b-app__view: .b-app__view-inner

            .b-app__head
                .b-app__head-hero

                    //.row
                        .col.col-xs-12 12

                .b-app__head-menu

                    //.row
                        .col.col-xs-12 12

            .b-app__body: .b-app__body-page

                h2 Это таймлайн
                .row(ng-controller="TimelineCtrl as timeline")
                    b-timeline(timeline-begin-date="timeline.beginDate",timeline-end-date="timeline.endDate",timeline-intervals="timeline.intervals") {{timeline}}
                .row
                    .col.col-xs-6
                        h3 1
                        .row(ng-controller="TimelineCtrl as timeline")
                            b-timeline(timeline-begin-date="timeline.beginDate",timeline-end-date="timeline.endDate",timeline-intervals="timeline.intervals") {{timeline}}
                    .col.col-xs-6
                        h3 2
                        .row(ng-controller="TimelineCtrl as timeline")
                            b-timeline(timeline-begin-date="timeline.beginDate",timeline-end-date="timeline.endDate",timeline-intervals="timeline.intervals") {{timeline}}
